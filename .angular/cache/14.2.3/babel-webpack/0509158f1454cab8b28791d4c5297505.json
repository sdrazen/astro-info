{"ast":null,"code":"import _classCallCheck from \"C:/Users/Fritz7x64/Documents/Angular/astro-info/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/Fritz7x64/Documents/Angular/astro-info/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nimport { Component } from '@angular/core';\nimport { AppComponent } from './app.component';\nimport { FirebaseAuthService } from './shared/firebase.auth.service';\nimport { GoogleService } from './shared/google.service';\nimport { UserSettingsService } from './shared/user.settings.service';\nimport { TranslationsService } from './shared/translations.service';\nimport { Router } from '@angular/router';\n\nvar UserSettingsComponent = /*#__PURE__*/function () {\n  function UserSettingsComponent(_firebaseAuthService, _router, _googleService, _userSettingsService, _translationsService, _appComponent) {\n    _classCallCheck(this, UserSettingsComponent);\n\n    this._firebaseAuthService = _firebaseAuthService;\n    this._router = _router;\n    this._googleService = _googleService;\n    this._userSettingsService = _userSettingsService;\n    this._translationsService = _translationsService;\n    this._appComponent = _appComponent; // Variables for user settings\n\n    this.lat = 0;\n    this.lng = 0;\n    this.timeZoneRawOffset = 0;\n    this.languageId = 0;\n    this.itemsPerPage = 0;\n    this.pagesPerPageset = 0;\n    this.userSettings = {\n      lat: 0,\n      lng: 0,\n      timeZoneRawOffset: 0,\n      languageId: 0,\n      itemsPerPage: 0,\n      pagesPerPageset: 0\n    }; // Variables for Google Maps\n\n    this.width = \"100%\";\n    this.height = \"100%\";\n    this.zoom = 10;\n    this.draggable = true;\n    this.iconUrl = \"assets/img/user.png\";\n    this.showSettingsUpdatedAlert = false; // Variables for various error messages\n\n    this.errorMessageGoogleTimeZone = \"\"; // Variables for Google Time Zone\n\n    this.timestamp = Math.round(new Date().getTime() / 1000.0); // Language list\n\n    this.languageList = []; // Current language title\n\n    this.languageTitle = \"\"; // Variables for translations\n\n    this.t_SettingsComponent_PanelTitle = \"Application settings\";\n    this.t_SettingsComponent_MapTitle = \"Click on map or drag marker to update Your location\";\n    this.t_SettingsComponent_Latitude = \"Latitude\";\n    this.t_SettingsComponent_Longitude = \"Longitude\";\n    this.t_SettingsComponent_DaylightSavingsOffset = \"Daylight savings offset (hours)\";\n    this.t_SettingsComponent_RawOffset = \"Raw offset (hours)\";\n    this.t_SettingsComponent_TimeZoneId = \"Time zone ID\";\n    this.t_SettingsComponent_TimeZoneName = \"Time zone name\";\n    this.t_SettingsComponent_OtherSettingsTitle = \"Select Your other preferred application settings\";\n    this.t_SettingsComponent_PreferredLanguage = \"Your preferred language\";\n    this.t_SettingsComponent_ItemsPerPage = \"Items per page in objects list\";\n    this.t_SettingsComponent_PagesPerPageset = \"Pages per pageset in objects list\";\n    this.t_SettingsComponent_SaveAlert = \"Your settings are updated and saved!\";\n    this.t_SettingsComponent_Save = \"Save\";\n    this.t_SettingsComponent_Choose = \"Choose\";\n  }\n\n  _createClass(UserSettingsComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      // var p = this._firebaseAuthService.listenForAuthStateChanges();\n      // p.then(user => {\n      //   this.isLoggedIn = true;\n      //   this.currentUser = user;\n      //   // Use user settings from service\n      //   this.lat = this._userSettingsService.lat;\n      //   this.lng = this._userSettingsService.lng;\n      //   this.timeZoneRawOffset = this._userSettingsService.timeZoneRawOffset;\n      //   this.languageId = this._userSettingsService.languageId;\n      //   this.itemsPerPage = this._userSettingsService.itemsPerPage;\n      //   this.pagesPerPageset = this._userSettingsService.pagesPerPageset;\n      //   // Get time zone from Google Time Zone API\n      //   this.timestamp = Math.round(new Date().getTime()/1000.0);\n      //   this._googleService.getTimeZone(this.lat.toString(), this.lng.toString(), this.timestamp).subscribe(timeZone => {this.timeZone = timeZone; this.timeZoneRawOffset = timeZone.rawOffset/3600;}, (err) => this.errorMessageGoogleTimeZone = err);\n      //   // Translations\n      //   this.translate(false);\n      // })\n      // .catch(value => {this.isLoggedIn = false; this._router.navigate (['/']);})\n      this.isLoggedIn = true; // this.currentUser = user;\n      // Use user settings from service\n\n      this.lat = this._userSettingsService.lat;\n      this.lng = this._userSettingsService.lng;\n      this.timeZoneRawOffset = this._userSettingsService.timeZoneRawOffset;\n      this.languageId = this._userSettingsService.languageId;\n      this.itemsPerPage = this._userSettingsService.itemsPerPage;\n      this.pagesPerPageset = this._userSettingsService.pagesPerPageset; // Get time zone from Google Time Zone API\n      // this.timestamp = Math.round(new Date().getTime() / 1000.0);\n      // this._googleService.getTimeZone(this.lat.toString(), this.lng.toString(), this.timestamp).subscribe(timeZone => { this.timeZone = timeZone; this.timeZoneRawOffset = timeZone.rawOffset / 3600; }, (err) => this.errorMessageGoogleTimeZone = err);\n      // Translations\n\n      this.translate(false);\n    }\n  }, {\n    key: \"onMapClick\",\n    value: function onMapClick($event) {\n      var _this = this;\n\n      this.lat = $event.coords.lat;\n      this.lng = $event.coords.lng; // Get time zone from Google Time Zone API\n\n      this.timestamp = Math.round(new Date().getTime() / 1000.0);\n\n      this._googleService.getTimeZone(this.lat.toString(), this.lng.toString(), this.timestamp).subscribe(function (timeZone) {\n        _this.timeZone = timeZone;\n        _this.timeZoneRawOffset = timeZone.rawOffset / 3600;\n      }, function (err) {\n        return _this.errorMessageGoogleTimeZone = err;\n      });\n    }\n  }, {\n    key: \"onMarkerDragEnd\",\n    value: function onMarkerDragEnd($event) {\n      var _this2 = this;\n\n      this.lat = $event.coords.lat;\n      this.lng = $event.coords.lng; // Get time zone from Google Time Zone API\n\n      this.timestamp = Math.round(new Date().getTime() / 1000.0);\n\n      this._googleService.getTimeZone(this.lat.toString(), this.lng.toString(), this.timestamp).subscribe(function (timeZone) {\n        _this2.timeZone = timeZone;\n        _this2.timeZoneRawOffset = timeZone.rawOffset / 3600;\n      }, function (err) {\n        return _this2.errorMessageGoogleTimeZone = err;\n      });\n    }\n  }, {\n    key: \"onSettingsSaveClick\",\n    value: function onSettingsSaveClick() {\n      // Prepare object to save through user settings service\n      this.userSettings.lat = parseFloat(this.lat.toString());\n      this.userSettings.lng = parseFloat(this.lng.toString());\n      this.userSettings.timeZoneRawOffset = parseInt(this.timeZoneRawOffset.toString());\n      this.userSettings.languageId = parseInt(this.languageId.toString());\n      this.userSettings.itemsPerPage = parseInt(this.itemsPerPage.toString());\n      this.userSettings.pagesPerPageset = parseInt(this.pagesPerPageset.toString()); // Save settings\n\n      this._userSettingsService.setUserSettings(this.userSettings); // Show update message to the user\n\n\n      this.showSettingsUpdateAlert(); // Set translations again because user may have changed his preferred langauge\n\n      this.translate(true);\n    }\n  }, {\n    key: \"showSettingsUpdateAlert\",\n    value: function showSettingsUpdateAlert() {\n      var _this3 = this;\n\n      this.showSettingsUpdatedAlert = true;\n      setTimeout(function () {\n        _this3.showSettingsUpdatedAlert = false;\n      }, 4000);\n    }\n  }, {\n    key: \"changeLanguage\",\n    value: function changeLanguage(languageId, languageTitle) {\n      this.languageId = languageId;\n      this.languageTitle = languageTitle;\n    }\n  }, {\n    key: \"getFlagPath\",\n    value: function getFlagPath(languageTitle) {\n      return \"/assets/flags/\" + languageTitle + \".png\";\n    }\n  }, {\n    key: \"translate\",\n    value: function translate(forceTranslation) {\n      var _this4 = this;\n\n      if (this._translationsService.translationsSetToVariables === false || forceTranslation === true) {\n        this._translationsService.setTranslationsForLanguage(this._userSettingsService.languageId).then(function () {\n          // Language list\n          _this4.languageList = _this4._translationsService.languageList; // Current language title\n\n          _this4.languageTitle = _this4._translationsService.languagetitle; // Translations\n\n          _this4.t_SettingsComponent_PanelTitle = _this4._translationsService.t_SettingsComponent_PanelTitle;\n          _this4.t_SettingsComponent_MapTitle = _this4._translationsService.t_SettingsComponent_MapTitle;\n          _this4.t_SettingsComponent_Latitude = _this4._translationsService.t_SettingsComponent_Latitude;\n          _this4.t_SettingsComponent_Longitude = _this4._translationsService.t_SettingsComponent_Longitude;\n          _this4.t_SettingsComponent_DaylightSavingsOffset = _this4._translationsService.t_SettingsComponent_DaylightSavingsOffset;\n          _this4.t_SettingsComponent_RawOffset = _this4._translationsService.t_SettingsComponent_RawOffset;\n          _this4.t_SettingsComponent_TimeZoneId = _this4._translationsService.t_SettingsComponent_TimeZoneId;\n          _this4.t_SettingsComponent_TimeZoneName = _this4._translationsService.t_SettingsComponent_TimeZoneName;\n          _this4.t_SettingsComponent_OtherSettingsTitle = _this4._translationsService.t_SettingsComponent_OtherSettingsTitle;\n          _this4.t_SettingsComponent_PreferredLanguage = _this4._translationsService.t_SettingsComponent_PreferredLanguage;\n          _this4.t_SettingsComponent_ItemsPerPage = _this4._translationsService.t_SettingsComponent_ItemsPerPage;\n          _this4.t_SettingsComponent_PagesPerPageset = _this4._translationsService.t_SettingsComponent_PagesPerPageset;\n          _this4.t_SettingsComponent_SaveAlert = _this4._translationsService.t_SettingsComponent_SaveAlert;\n          _this4.t_SettingsComponent_Save = _this4._translationsService.t_SettingsComponent_Save;\n          _this4.t_SettingsComponent_Choose = _this4._translationsService.t_SettingsComponent_Choose; // If user just saved new user settings (forceTranslation = true), then take care of AppComponent's menus, show changes right away if user changed language\n\n          if (forceTranslation === true) {\n            _this4._appComponent.languageId = _this4._userSettingsService.languageId;\n            _this4._appComponent.t_AppComponent_Home = _this4._translationsService.t_AppComponent_Home;\n            _this4._appComponent.t_AppComponent_Objects = _this4._translationsService.t_AppComponent_Objects;\n            _this4._appComponent.t_AppComponent_Data = _this4._translationsService.t_AppComponent_Data;\n            _this4._appComponent.t_AppComponent_DeepSky = _this4._translationsService.t_AppComponent_DeepSky;\n            _this4._appComponent.t_AppComponent_Calculator = _this4._translationsService.t_AppComponent_Calculator;\n            _this4._appComponent.t_AppComponent_Apod = _this4._translationsService.t_AppComponent_Apod;\n            _this4._appComponent.t_AppComponent_Neo = _this4._translationsService.t_AppComponent_Neo;\n            _this4._appComponent.t_AppComponent_SolarEclipses = _this4._translationsService.t_AppComponent_SolarEclipses;\n            _this4._appComponent.t_AppComponent_LunarEclipses = _this4._translationsService.t_AppComponent_LunarEclipses;\n            _this4._appComponent.t_AppComponent_SunAndMoon = _this4._translationsService.t_AppComponent_SunAndMoon;\n            _this4._appComponent.t_AppComponent_Iss = _this4._translationsService.t_AppComponent_Iss;\n            _this4._appComponent.t_AppComponent_Moonfeatures = _this4._translationsService.t_AppComponent_Moonfeatures;\n            _this4._appComponent.t_AppComponent_Stores = _this4._translationsService.t_AppComponent_Stores;\n            _this4._appComponent.t_AppComponent_Locations = _this4._translationsService.t_AppComponent_Locations;\n            _this4._appComponent.t_AppComponent_Weather = _this4._translationsService.t_AppComponent_Weather;\n            _this4._appComponent.t_AppComponent_Settings = _this4._translationsService.t_AppComponent_Settings;\n            _this4._appComponent.t_AppComponent_About = _this4._translationsService.t_AppComponent_About;\n            _this4._appComponent.t_AppComponent_Others = _this4._translationsService.t_AppComponent_Others;\n            _this4._appComponent.t_AppComponent_Logout = _this4._translationsService.t_AppComponent_Logout;\n          }\n        });\n      } else {\n        // Language list\n        this.languageList = this._translationsService.languageList; // Current language title\n\n        this.languageTitle = this._translationsService.languagetitle; // Translations\n\n        this.t_SettingsComponent_PanelTitle = this._translationsService.t_SettingsComponent_PanelTitle;\n        this.t_SettingsComponent_MapTitle = this._translationsService.t_SettingsComponent_MapTitle;\n        this.t_SettingsComponent_Latitude = this._translationsService.t_SettingsComponent_Latitude;\n        this.t_SettingsComponent_Longitude = this._translationsService.t_SettingsComponent_Longitude;\n        this.t_SettingsComponent_DaylightSavingsOffset = this._translationsService.t_SettingsComponent_DaylightSavingsOffset;\n        this.t_SettingsComponent_RawOffset = this._translationsService.t_SettingsComponent_RawOffset;\n        this.t_SettingsComponent_TimeZoneId = this._translationsService.t_SettingsComponent_TimeZoneId;\n        this.t_SettingsComponent_TimeZoneName = this._translationsService.t_SettingsComponent_TimeZoneName;\n        this.t_SettingsComponent_OtherSettingsTitle = this._translationsService.t_SettingsComponent_OtherSettingsTitle;\n        this.t_SettingsComponent_PreferredLanguage = this._translationsService.t_SettingsComponent_PreferredLanguage;\n        this.t_SettingsComponent_ItemsPerPage = this._translationsService.t_SettingsComponent_ItemsPerPage;\n        this.t_SettingsComponent_PagesPerPageset = this._translationsService.t_SettingsComponent_PagesPerPageset;\n        this.t_SettingsComponent_SaveAlert = this._translationsService.t_SettingsComponent_SaveAlert;\n        this.t_SettingsComponent_Save = this._translationsService.t_SettingsComponent_Save;\n        this.t_SettingsComponent_Choose = this._translationsService.t_SettingsComponent_Choose;\n      }\n    }\n  }]);\n\n  return UserSettingsComponent;\n}();\n\nUserSettingsComponent = __decorate([Component({\n  selector: 'app-usersettings',\n  templateUrl: './user.settings.component.html',\n  styleUrls: ['./user.settings.component.css']\n}), __metadata(\"design:paramtypes\", [FirebaseAuthService, Router, GoogleService, UserSettingsService, TranslationsService, AppComponent])], UserSettingsComponent);\nexport { UserSettingsComponent };","map":null,"metadata":{},"sourceType":"module"}